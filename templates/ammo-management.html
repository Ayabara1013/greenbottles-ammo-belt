<style>
  .ammo-management-table {
    width: 100%;
    border-collapse: collapse;
  }
  
  .ammo-management-table thead tr {
    border-bottom: 2px solid #999;
  }
  
  .ammo-management-table th {
    text-align: left;
    padding: 8px;
    font-weight: bold;
  }
  
  .ammo-management-table tbody tr {
    border-bottom: 1px solid #ccc;
  }
  
  .ammo-management-table tbody tr.modified {
    background-color: rgba(255, 165, 0, 0.1);
  }
  
  .ammo-management-table td {
    padding: 8px;
  }
  
  .status-icon {
    text-align: center;
    width: 30px;
  }
  
  .weapon-ammo-select {
    width: 100%;
  }
</style>

<form>
  <nav class="tabs" data-group="main">
    <a class="item" data-tab="bulk">
      <i class="fas fa-boxes"></i> Bulk Operations
    </a>
    <a class="item" data-tab="individual">
      <i class="fas fa-sliders-h"></i> Individual Settings
      {{#if hasPendingChanges}}
        <i class="fas fa-circle" style="color: orange; font-size: 0.5em; vertical-align: super;"></i>
      {{/if}}
    </a>
  </nav>

  <section class="content">
    <!-- Bulk Operations Tab -->
    <div class="tab" data-tab="bulk">
      <div class="form-group">
        <p class="notes">
          Use these buttons to manage ammunition types for all configured weapons at once.
          This will affect all weapons in the world and in actor inventories.
        </p>
      </div>

      <div class="form-group">
        <label>Status:</label>
        <p>
          {{#if customAmmoAssigned}}
            <i class="fas fa-check-circle" style="color: green;"></i> Custom ammo types are currently assigned
          {{else}}
            <i class="fas fa-times-circle" style="color: orange;"></i> Using basic projectile ammo
          {{/if}}
        </p>
      </div>

      <div class="form-group">
        <button type="button" id="assign-custom-ammo" class="bright">
          <i class="fas fa-box-open"></i> Assign All Custom Ammo Types
        </button>
      </div>

      <div class="form-group">
        <button type="button" id="reset-ammo">
          <i class="fas fa-undo"></i> Reset All to Basic Ammo
        </button>
      </div>

      <div class="form-group">
        <p class="notes" style="font-size: 0.9em; color: #666;">
          <strong>Note:</strong> Make sure your custom ammo types are created in your compendium before assigning them.
        </p>
      </div>
    </div>

    <!-- Individual Settings Tab -->
    <div class="tab" data-tab="individual">
      <div class="form-group">
        <p class="notes">
          Configure ammo types for individual weapons. Status indicators show:
          <span style="display: inline-block; margin-left: 10px;">
            <i class="fas fa-check-circle" style="color: green;"></i> Default
          </span>
          <span style="display: inline-block; margin-left: 10px;">
            <i class="fas fa-circle" style="color: blue;"></i> Custom (saved)
          </span>
          <span style="display: inline-block; margin-left: 10px;">
            <i class="fas fa-circle" style="color: orange;"></i> Unsaved changes
          </span>
        </p>
      </div>

      <div class="form-group">
        <table class="ammo-management-table">
          <thead>
            <tr>
              <th style="width: 30px;"></th>
              <th>Weapon</th>
              <th>Ammo Type</th>
            </tr>
          </thead>
          <tbody>
            {{#each weaponConfigs}}
            <tr {{#if this.isModified}}class="modified"{{/if}}>
              <td class="status-icon">
                {{#if this.isModified}}
                  <i class="fas fa-circle" style="color: orange;" title="Unsaved changes"></i>
                {{else if this.hasOverride}}
                  <i class="fas fa-circle" style="color: blue;" title="Custom assignment saved"></i>
                {{else}}
                  <i class="fas fa-check-circle" style="color: green;" title="Using default"></i>
                {{/if}}
              </td>
              <td>{{this.name}}</td>
              <td>
                <select 
                  class="weapon-ammo-select" 
                  data-weapon-slug="{{this.slug}}"
                  data-weapon-name="{{this.name}}"
                  data-default-type="{{this.defaultType}}">
                  {{#each ../availableAmmoTypes}}
                  <option 
                    value="{{this.key}}"
                    {{#if (eq this.key ../../currentType)}}selected{{/if}}>
                    {{this.label}}
                  </option>
                  {{/each}}
                </select>
              </td>
            </tr>
            {{/each}}
          </tbody>
        </table>
      </div>

      <div class="form-group" style="display: flex; gap: 10px;">
        <button type="button" id="apply-individual" class="bright" style="flex: 1;" disabled>
          <i class="fas fa-check"></i> Apply Changes
        </button>
        <button type="button" id="reset-individual" style="flex: 1;">
          <i class="fas fa-undo"></i> Reset All to Defaults
        </button>
      </div>

      <div class="form-group">
        <p class="notes" style="font-size: 0.9em; color: #666;">
          <strong>Note:</strong> Individual assignments override the defaults. Change a dropdown to mark it for updating, then click "Apply Changes" to save.
        </p>
      </div>
    </div>
  </section>
</form>